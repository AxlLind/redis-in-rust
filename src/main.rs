use std::collections::HashMap;
use anyhow;

mod command;
use command::Parser;

enum Value {
    String(Vec<u8>),
    Hash(HashMap<Vec<u8>, Vec<u8>>),
}

fn execute_command(state: &mut HashMap<Vec<u8>, Value>, cmd: &[Vec<u8>]) -> anyhow::Result<()> {
    match cmd[0].as_slice() {
        b"ACL CAT"                      => anyhow::bail!("TODO: support ACL CAT"),
        b"ACL DELUSER"                  => anyhow::bail!("TODO: support ACL DELUSER"),
        b"ACL DRYRUN"                   => anyhow::bail!("TODO: support ACL DRYRUN"),
        b"ACL GENPASS"                  => anyhow::bail!("TODO: support ACL GENPASS"),
        b"ACL GETUSER"                  => anyhow::bail!("TODO: support ACL GETUSER"),
        b"ACL LIST"                     => anyhow::bail!("TODO: support ACL LIST"),
        b"ACL LOAD"                     => anyhow::bail!("TODO: support ACL LOAD"),
        b"ACL LOG"                      => anyhow::bail!("TODO: support ACL LOG"),
        b"ACL SAVE"                     => anyhow::bail!("TODO: support ACL SAVE"),
        b"ACL SETUSER"                  => anyhow::bail!("TODO: support ACL SETUSER"),
        b"ACL USERS"                    => anyhow::bail!("TODO: support ACL USERS"),
        b"ACL WHOAMI"                   => anyhow::bail!("TODO: support ACL WHOAMI"),
        b"APPEND"                       => anyhow::bail!("TODO: support APPEND"),
        b"ASKING"                       => anyhow::bail!("TODO: support ASKING"),
        b"AUTH"                         => anyhow::bail!("TODO: support AUTH"),
        b"BF.ADD"                       => anyhow::bail!("TODO: support BF.ADD"),
        b"BF.CARD"                      => anyhow::bail!("TODO: support BF.CARD"),
        b"BF.EXISTS"                    => anyhow::bail!("TODO: support BF.EXISTS"),
        b"BF.INFO"                      => anyhow::bail!("TODO: support BF.INFO"),
        b"BF.INSERT"                    => anyhow::bail!("TODO: support BF.INSERT"),
        b"BF.LOADCHUNK"                 => anyhow::bail!("TODO: support BF.LOADCHUNK"),
        b"BF.MADD"                      => anyhow::bail!("TODO: support BF.MADD"),
        b"BF.MEXISTS"                   => anyhow::bail!("TODO: support BF.MEXISTS"),
        b"BF.RESERVE"                   => anyhow::bail!("TODO: support BF.RESERVE"),
        b"BF.SCANDUMP"                  => anyhow::bail!("TODO: support BF.SCANDUMP"),
        b"BGREWRITEAOF"                 => anyhow::bail!("TODO: support BGREWRITEAOF"),
        b"BGSAVE"                       => anyhow::bail!("TODO: support BGSAVE"),
        b"BITCOUNT"                     => anyhow::bail!("TODO: support BITCOUNT"),
        b"BITFIELD"                     => anyhow::bail!("TODO: support BITFIELD"),
        b"BITFIELD_RO"                  => anyhow::bail!("TODO: support BITFIELD_RO"),
        b"BITOP"                        => anyhow::bail!("TODO: support BITOP"),
        b"BITPOS"                       => anyhow::bail!("TODO: support BITPOS"),
        b"BLMOVE"                       => anyhow::bail!("TODO: support BLMOVE"),
        b"BLMPOP"                       => anyhow::bail!("TODO: support BLMPOP"),
        b"BLPOP"                        => anyhow::bail!("TODO: support BLPOP"),
        b"BRPOP"                        => anyhow::bail!("TODO: support BRPOP"),
        b"BRPOPLPUSH"                   => anyhow::bail!("TODO: support BRPOPLPUSH"),
        b"BZMPOP"                       => anyhow::bail!("TODO: support BZMPOP"),
        b"BZPOPMAX"                     => anyhow::bail!("TODO: support BZPOPMAX"),
        b"BZPOPMIN"                     => anyhow::bail!("TODO: support BZPOPMIN"),
        b"CF.ADD"                       => anyhow::bail!("TODO: support CF.ADD"),
        b"CF.ADDNX"                     => anyhow::bail!("TODO: support CF.ADDNX"),
        b"CF.COUNT"                     => anyhow::bail!("TODO: support CF.COUNT"),
        b"CF.DEL"                       => anyhow::bail!("TODO: support CF.DEL"),
        b"CF.EXISTS"                    => anyhow::bail!("TODO: support CF.EXISTS"),
        b"CF.INFO"                      => anyhow::bail!("TODO: support CF.INFO"),
        b"CF.INSERT"                    => anyhow::bail!("TODO: support CF.INSERT"),
        b"CF.INSERTNX"                  => anyhow::bail!("TODO: support CF.INSERTNX"),
        b"CF.LOADCHUNK"                 => anyhow::bail!("TODO: support CF.LOADCHUNK"),
        b"CF.MEXISTS"                   => anyhow::bail!("TODO: support CF.MEXISTS"),
        b"CF.RESERVE"                   => anyhow::bail!("TODO: support CF.RESERVE"),
        b"CF.SCANDUMP"                  => anyhow::bail!("TODO: support CF.SCANDUMP"),
        b"CLIENT CACHING"               => anyhow::bail!("TODO: support CLIENT CACHING"),
        b"CLIENT GETNAME"               => anyhow::bail!("TODO: support CLIENT GETNAME"),
        b"CLIENT GETREDIR"              => anyhow::bail!("TODO: support CLIENT GETREDIR"),
        b"CLIENT ID"                    => anyhow::bail!("TODO: support CLIENT ID"),
        b"CLIENT INFO"                  => anyhow::bail!("TODO: support CLIENT INFO"),
        b"CLIENT KILL"                  => anyhow::bail!("TODO: support CLIENT KILL"),
        b"CLIENT LIST"                  => anyhow::bail!("TODO: support CLIENT LIST"),
        b"CLIENT NO-EVICT"              => anyhow::bail!("TODO: support CLIENT NO-EVICT"),
        b"CLIENT NO-TOUCH"              => anyhow::bail!("TODO: support CLIENT NO-TOUCH"),
        b"CLIENT PAUSE"                 => anyhow::bail!("TODO: support CLIENT PAUSE"),
        b"CLIENT REPLY"                 => anyhow::bail!("TODO: support CLIENT REPLY"),
        b"CLIENT SETINFO"               => anyhow::bail!("TODO: support CLIENT SETINFO"),
        b"CLIENT SETNAME"               => anyhow::bail!("TODO: support CLIENT SETNAME"),
        b"CLIENT TRACKING"              => anyhow::bail!("TODO: support CLIENT TRACKING"),
        b"CLIENT TRACKINGINFO"          => anyhow::bail!("TODO: support CLIENT TRACKINGINFO"),
        b"CLIENT UNBLOCK"               => anyhow::bail!("TODO: support CLIENT UNBLOCK"),
        b"CLIENT UNPAUSE"               => anyhow::bail!("TODO: support CLIENT UNPAUSE"),
        b"CLUSTER ADDSLOTS"             => anyhow::bail!("TODO: support CLUSTER ADDSLOTS"),
        b"CLUSTER ADDSLOTSRANGE"        => anyhow::bail!("TODO: support CLUSTER ADDSLOTSRANGE"),
        b"CLUSTER BUMPEPOCH"            => anyhow::bail!("TODO: support CLUSTER BUMPEPOCH"),
        b"CLUSTER COUNT-FAILURE-REPORTS"=> anyhow::bail!("TODO: support CLUSTER COUNT-FAILURE-REPORTS"),
        b"CLUSTER COUNTKEYSINSLOT"      => anyhow::bail!("TODO: support CLUSTER COUNTKEYSINSLOT"),
        b"CLUSTER DELSLOTS"             => anyhow::bail!("TODO: support CLUSTER DELSLOTS"),
        b"CLUSTER DELSLOTSRANGE"        => anyhow::bail!("TODO: support CLUSTER DELSLOTSRANGE"),
        b"CLUSTER FAILOVER"             => anyhow::bail!("TODO: support CLUSTER FAILOVER"),
        b"CLUSTER FLUSHSLOTS"           => anyhow::bail!("TODO: support CLUSTER FLUSHSLOTS"),
        b"CLUSTER FORGET"               => anyhow::bail!("TODO: support CLUSTER FORGET"),
        b"CLUSTER GETKEYSINSLOT"        => anyhow::bail!("TODO: support CLUSTER GETKEYSINSLOT"),
        b"CLUSTER INFO"                 => anyhow::bail!("TODO: support CLUSTER INFO"),
        b"CLUSTER KEYSLOT"              => anyhow::bail!("TODO: support CLUSTER KEYSLOT"),
        b"CLUSTER LINKS"                => anyhow::bail!("TODO: support CLUSTER LINKS"),
        b"CLUSTER MEET"                 => anyhow::bail!("TODO: support CLUSTER MEET"),
        b"CLUSTER MYID"                 => anyhow::bail!("TODO: support CLUSTER MYID"),
        b"CLUSTER MYSHARDID"            => anyhow::bail!("TODO: support CLUSTER MYSHARDID"),
        b"CLUSTER NODES"                => anyhow::bail!("TODO: support CLUSTER NODES"),
        b"CLUSTER REPLICAS"             => anyhow::bail!("TODO: support CLUSTER REPLICAS"),
        b"CLUSTER REPLICATE"            => anyhow::bail!("TODO: support CLUSTER REPLICATE"),
        b"CLUSTER RESET"                => anyhow::bail!("TODO: support CLUSTER RESET"),
        b"CLUSTER SAVECONFIG"           => anyhow::bail!("TODO: support CLUSTER SAVECONFIG"),
        b"CLUSTER SET-CONFIG-EPOCH"     => anyhow::bail!("TODO: support CLUSTER SET-CONFIG-EPOCH"),
        b"CLUSTER SETSLOT"              => anyhow::bail!("TODO: support CLUSTER SETSLOT"),
        b"CLUSTER SHARDS"               => anyhow::bail!("TODO: support CLUSTER SHARDS"),
        b"CLUSTER SLAVES"               => anyhow::bail!("TODO: support CLUSTER SLAVES"),
        b"CLUSTER SLOTS"                => anyhow::bail!("TODO: support CLUSTER SLOTS"),
        b"CMS.INCRBY"                   => anyhow::bail!("TODO: support CMS.INCRBY"),
        b"CMS.INFO"                     => anyhow::bail!("TODO: support CMS.INFO"),
        b"CMS.INITBYDIM"                => anyhow::bail!("TODO: support CMS.INITBYDIM"),
        b"CMS.INITBYPROB"               => anyhow::bail!("TODO: support CMS.INITBYPROB"),
        b"CMS.MERGE"                    => anyhow::bail!("TODO: support CMS.MERGE"),
        b"CMS.QUERY"                    => anyhow::bail!("TODO: support CMS.QUERY"),
        b"COMMAND"                      => anyhow::bail!("TODO: support COMMAND"),
        b"COMMAND COUNT"                => anyhow::bail!("TODO: support COMMAND COUNT"),
        b"COMMAND DOCS"                 => anyhow::bail!("TODO: support COMMAND DOCS"),
        b"COMMAND GETKEYS"              => anyhow::bail!("TODO: support COMMAND GETKEYS"),
        b"COMMAND GETKEYSANDFLAGS"      => anyhow::bail!("TODO: support COMMAND GETKEYSANDFLAGS"),
        b"COMMAND INFO"                 => anyhow::bail!("TODO: support COMMAND INFO"),
        b"COMMAND LIST"                 => anyhow::bail!("TODO: support COMMAND LIST"),
        b"CONFIG GET"                   => anyhow::bail!("TODO: support CONFIG GET"),
        b"CONFIG RESETSTAT"             => anyhow::bail!("TODO: support CONFIG RESETSTAT"),
        b"CONFIG REWRITE"               => anyhow::bail!("TODO: support CONFIG REWRITE"),
        b"CONFIG SET"                   => anyhow::bail!("TODO: support CONFIG SET"),
        b"COPY"                         => anyhow::bail!("TODO: support COPY"),
        b"DBSIZE"                       => anyhow::bail!("TODO: support DBSIZE"),
        b"DECR"                         => anyhow::bail!("TODO: support DECR"),
        b"DECRBY"                       => anyhow::bail!("TODO: support DECRBY"),
        b"DEL"                          => anyhow::bail!("TODO: support DEL"),
        b"DISCARD"                      => anyhow::bail!("TODO: support DISCARD"),
        b"DUMP"                         => anyhow::bail!("TODO: support DUMP"),
        b"ECHO"                         => anyhow::bail!("TODO: support ECHO"),
        b"EVAL"                         => anyhow::bail!("TODO: support EVAL"),
        b"EVAL_RO"                      => anyhow::bail!("TODO: support EVAL_RO"),
        b"EVALSHA"                      => anyhow::bail!("TODO: support EVALSHA"),
        b"EVALSHA_RO"                   => anyhow::bail!("TODO: support EVALSHA_RO"),
        b"EXEC"                         => anyhow::bail!("TODO: support EXEC"),
        b"EXISTS"                       => anyhow::bail!("TODO: support EXISTS"),
        b"EXPIRE"                       => anyhow::bail!("TODO: support EXPIRE"),
        b"EXPIREAT"                     => anyhow::bail!("TODO: support EXPIREAT"),
        b"EXPIRETIME"                   => anyhow::bail!("TODO: support EXPIRETIME"),
        b"FAILOVER"                     => anyhow::bail!("TODO: support FAILOVER"),
        b"FCALL"                        => anyhow::bail!("TODO: support FCALL"),
        b"FCALL_RO"                     => anyhow::bail!("TODO: support FCALL_RO"),
        b"FLUSHALL"                     => anyhow::bail!("TODO: support FLUSHALL"),
        b"FLUSHDB"                      => anyhow::bail!("TODO: support FLUSHDB"),
        b"FT._LIST"                     => anyhow::bail!("TODO: support FT._LIST"),
        b"FT.AGGREGATE"                 => anyhow::bail!("TODO: support FT.AGGREGATE"),
        b"FT.ALIASADD"                  => anyhow::bail!("TODO: support FT.ALIASADD"),
        b"FT.ALIASDEL"                  => anyhow::bail!("TODO: support FT.ALIASDEL"),
        b"FT.ALIASUPDATE"               => anyhow::bail!("TODO: support FT.ALIASUPDATE"),
        b"FT.ALTER"                     => anyhow::bail!("TODO: support FT.ALTER"),
        b"FT.CONFIG GET"                => anyhow::bail!("TODO: support FT.CONFIG GET"),
        b"FT.CONFIG SET"                => anyhow::bail!("TODO: support FT.CONFIG SET"),
        b"FT.CREATE"                    => anyhow::bail!("TODO: support FT.CREATE"),
        b"FT.CURSOR DEL"                => anyhow::bail!("TODO: support FT.CURSOR DEL"),
        b"FT.CURSOR READ"               => anyhow::bail!("TODO: support FT.CURSOR READ"),
        b"FT.DICTADD"                   => anyhow::bail!("TODO: support FT.DICTADD"),
        b"FT.DICTDEL"                   => anyhow::bail!("TODO: support FT.DICTDEL"),
        b"FT.DICTDUMP"                  => anyhow::bail!("TODO: support FT.DICTDUMP"),
        b"FT.DROPINDEX"                 => anyhow::bail!("TODO: support FT.DROPINDEX"),
        b"FT.EXPLAIN"                   => anyhow::bail!("TODO: support FT.EXPLAIN"),
        b"FT.EXPLAINCLI"                => anyhow::bail!("TODO: support FT.EXPLAINCLI"),
        b"FT.INFO"                      => anyhow::bail!("TODO: support FT.INFO"),
        b"FT.PROFILE"                   => anyhow::bail!("TODO: support FT.PROFILE"),
        b"FT.SEARCH"                    => anyhow::bail!("TODO: support FT.SEARCH"),
        b"FT.SPELLCHECK"                => anyhow::bail!("TODO: support FT.SPELLCHECK"),
        b"FT.SUGADD"                    => anyhow::bail!("TODO: support FT.SUGADD"),
        b"FT.SUGDEL"                    => anyhow::bail!("TODO: support FT.SUGDEL"),
        b"FT.SUGGET"                    => anyhow::bail!("TODO: support FT.SUGGET"),
        b"FT.SUGLEN"                    => anyhow::bail!("TODO: support FT.SUGLEN"),
        b"FT.SYNDUMP"                   => anyhow::bail!("TODO: support FT.SYNDUMP"),
        b"FT.SYNUPDATE"                 => anyhow::bail!("TODO: support FT.SYNUPDATE"),
        b"FT.TAGVALS"                   => anyhow::bail!("TODO: support FT.TAGVALS"),
        b"FUNCTION DELETE"              => anyhow::bail!("TODO: support FUNCTION DELETE"),
        b"FUNCTION DUMP"                => anyhow::bail!("TODO: support FUNCTION DUMP"),
        b"FUNCTION FLUSH"               => anyhow::bail!("TODO: support FUNCTION FLUSH"),
        b"FUNCTION KILL"                => anyhow::bail!("TODO: support FUNCTION KILL"),
        b"FUNCTION LIST"                => anyhow::bail!("TODO: support FUNCTION LIST"),
        b"FUNCTION LOAD"                => anyhow::bail!("TODO: support FUNCTION LOAD"),
        b"FUNCTION RESTORE"             => anyhow::bail!("TODO: support FUNCTION RESTORE"),
        b"FUNCTION STATS"               => anyhow::bail!("TODO: support FUNCTION STATS"),
        b"GEOADD"                       => anyhow::bail!("TODO: support GEOADD"),
        b"GEODIST"                      => anyhow::bail!("TODO: support GEODIST"),
        b"GEOHASH"                      => anyhow::bail!("TODO: support GEOHASH"),
        b"GEOPOS"                       => anyhow::bail!("TODO: support GEOPOS"),
        b"GEORADIUS"                    => anyhow::bail!("TODO: support GEORADIUS"),
        b"GEORADIUS_RO"                 => anyhow::bail!("TODO: support GEORADIUS_RO"),
        b"GEORADIUSBYMEMBER"            => anyhow::bail!("TODO: support GEORADIUSBYMEMBER"),
        b"GEORADIUSBYMEMBER_RO"         => anyhow::bail!("TODO: support GEORADIUSBYMEMBER_RO"),
        b"GEOSEARCH"                    => anyhow::bail!("TODO: support GEOSEARCH"),
        b"GEOSEARCHSTORE"               => anyhow::bail!("TODO: support GEOSEARCHSTORE"),
        b"GET"                          => anyhow::bail!("TODO: support GET"),
        b"GETBIT"                       => anyhow::bail!("TODO: support GETBIT"),
        b"GETDEL"                       => anyhow::bail!("TODO: support GETDEL"),
        b"GETEX"                        => anyhow::bail!("TODO: support GETEX"),
        b"GETRANGE"                     => anyhow::bail!("TODO: support GETRANGE"),
        b"GETSET"                       => anyhow::bail!("TODO: support GETSET"),
        b"HDEL"                         => anyhow::bail!("TODO: support HDEL"),
        b"HELLO"                        => anyhow::bail!("TODO: support HELLO"),
        b"HEXISTS"                      => anyhow::bail!("TODO: support HEXISTS"),
        b"HGET"                         => anyhow::bail!("TODO: support HGET"),
        b"HGETALL"                      => anyhow::bail!("TODO: support HGETALL"),
        b"HINCRBY"                      => anyhow::bail!("TODO: support HINCRBY"),
        b"HINCRBYFLOAT"                 => anyhow::bail!("TODO: support HINCRBYFLOAT"),
        b"HKEYS"                        => anyhow::bail!("TODO: support HKEYS"),
        b"HLEN"                         => anyhow::bail!("TODO: support HLEN"),
        b"HMGET"                        => anyhow::bail!("TODO: support HMGET"),
        b"HMSET"                        => anyhow::bail!("TODO: support HMSET"),
        b"HRANDFIELD"                   => anyhow::bail!("TODO: support HRANDFIELD"),
        b"HSCAN"                        => anyhow::bail!("TODO: support HSCAN"),
        b"HSET"                         => anyhow::bail!("TODO: support HSET"),
        b"HSETNX"                       => anyhow::bail!("TODO: support HSETNX"),
        b"HSTRLEN"                      => anyhow::bail!("TODO: support HSTRLEN"),
        b"HVALS"                        => anyhow::bail!("TODO: support HVALS"),
        b"INCR"                         => anyhow::bail!("TODO: support INCR"),
        b"INCRBY"                       => anyhow::bail!("TODO: support INCRBY"),
        b"INCRBYFLOAT"                  => anyhow::bail!("TODO: support INCRBYFLOAT"),
        b"INFO"                         => anyhow::bail!("TODO: support INFO"),
        b"JSON.ARRAPPEND"               => anyhow::bail!("TODO: support JSON.ARRAPPEND"),
        b"JSON.ARRINDEX"                => anyhow::bail!("TODO: support JSON.ARRINDEX"),
        b"JSON.ARRINSERT"               => anyhow::bail!("TODO: support JSON.ARRINSERT"),
        b"JSON.ARRLEN"                  => anyhow::bail!("TODO: support JSON.ARRLEN"),
        b"JSON.ARRPOP"                  => anyhow::bail!("TODO: support JSON.ARRPOP"),
        b"JSON.ARRTRIM"                 => anyhow::bail!("TODO: support JSON.ARRTRIM"),
        b"JSON.CLEAR"                   => anyhow::bail!("TODO: support JSON.CLEAR"),
        b"JSON.DEBUG"                   => anyhow::bail!("TODO: support JSON.DEBUG"),
        b"JSON.DEBUG MEMORY"            => anyhow::bail!("TODO: support JSON.DEBUG MEMORY"),
        b"JSON.DEL"                     => anyhow::bail!("TODO: support JSON.DEL"),
        b"JSON.FORGET"                  => anyhow::bail!("TODO: support JSON.FORGET"),
        b"JSON.GET"                     => anyhow::bail!("TODO: support JSON.GET"),
        b"JSON.MERGE"                   => anyhow::bail!("TODO: support JSON.MERGE"),
        b"JSON.MGET"                    => anyhow::bail!("TODO: support JSON.MGET"),
        b"JSON.MSET"                    => anyhow::bail!("TODO: support JSON.MSET"),
        b"JSON.NUMINCRBY"               => anyhow::bail!("TODO: support JSON.NUMINCRBY"),
        b"JSON.NUMMULTBY"               => anyhow::bail!("TODO: support JSON.NUMMULTBY"),
        b"JSON.OBJKEYS"                 => anyhow::bail!("TODO: support JSON.OBJKEYS"),
        b"JSON.OBJLEN"                  => anyhow::bail!("TODO: support JSON.OBJLEN"),
        b"JSON.RESP"                    => anyhow::bail!("TODO: support JSON.RESP"),
        b"JSON.SET"                     => anyhow::bail!("TODO: support JSON.SET"),
        b"JSON.STRAPPEND"               => anyhow::bail!("TODO: support JSON.STRAPPEND"),
        b"JSON.STRLEN"                  => anyhow::bail!("TODO: support JSON.STRLEN"),
        b"JSON.TOGGLE"                  => anyhow::bail!("TODO: support JSON.TOGGLE"),
        b"JSON.TYPE"                    => anyhow::bail!("TODO: support JSON.TYPE"),
        b"KEYS"                         => anyhow::bail!("TODO: support KEYS"),
        b"LASTSAVE"                     => anyhow::bail!("TODO: support LASTSAVE"),
        b"LATENCY DOCTOR"               => anyhow::bail!("TODO: support LATENCY DOCTOR"),
        b"LATENCY GRAPH"                => anyhow::bail!("TODO: support LATENCY GRAPH"),
        b"LATENCY HISTOGRAM"            => anyhow::bail!("TODO: support LATENCY HISTOGRAM"),
        b"LATENCY HISTORY"              => anyhow::bail!("TODO: support LATENCY HISTORY"),
        b"LATENCY LATEST"               => anyhow::bail!("TODO: support LATENCY LATEST"),
        b"LATENCY RESET"                => anyhow::bail!("TODO: support LATENCY RESET"),
        b"LCS"                          => anyhow::bail!("TODO: support LCS"),
        b"LINDEX"                       => anyhow::bail!("TODO: support LINDEX"),
        b"LINSERT"                      => anyhow::bail!("TODO: support LINSERT"),
        b"LLEN"                         => anyhow::bail!("TODO: support LLEN"),
        b"LMOVE"                        => anyhow::bail!("TODO: support LMOVE"),
        b"LMPOP"                        => anyhow::bail!("TODO: support LMPOP"),
        b"LOLWUT"                       => anyhow::bail!("TODO: support LOLWUT"),
        b"LPOP"                         => anyhow::bail!("TODO: support LPOP"),
        b"LPOS"                         => anyhow::bail!("TODO: support LPOS"),
        b"LPUSH"                        => anyhow::bail!("TODO: support LPUSH"),
        b"LPUSHX"                       => anyhow::bail!("TODO: support LPUSHX"),
        b"LRANGE"                       => anyhow::bail!("TODO: support LRANGE"),
        b"LREM"                         => anyhow::bail!("TODO: support LREM"),
        b"LSET"                         => anyhow::bail!("TODO: support LSET"),
        b"LTRIM"                        => anyhow::bail!("TODO: support LTRIM"),
        b"MEMORY DOCTOR"                => anyhow::bail!("TODO: support MEMORY DOCTOR"),
        b"MEMORY MALLOC-STATS"          => anyhow::bail!("TODO: support MEMORY MALLOC-STATS"),
        b"MEMORY PURGE"                 => anyhow::bail!("TODO: support MEMORY PURGE"),
        b"MEMORY STATS"                 => anyhow::bail!("TODO: support MEMORY STATS"),
        b"MEMORY USAGE"                 => anyhow::bail!("TODO: support MEMORY USAGE"),
        b"MGET"                         => anyhow::bail!("TODO: support MGET"),
        b"MIGRATE"                      => anyhow::bail!("TODO: support MIGRATE"),
        b"MODULE LIST"                  => anyhow::bail!("TODO: support MODULE LIST"),
        b"MODULE LOAD"                  => anyhow::bail!("TODO: support MODULE LOAD"),
        b"MODULE LOADEX"                => anyhow::bail!("TODO: support MODULE LOADEX"),
        b"MODULE UNLOAD"                => anyhow::bail!("TODO: support MODULE UNLOAD"),
        b"MONITOR"                      => anyhow::bail!("TODO: support MONITOR"),
        b"MOVE"                         => anyhow::bail!("TODO: support MOVE"),
        b"MSET"                         => anyhow::bail!("TODO: support MSET"),
        b"MSETNX"                       => anyhow::bail!("TODO: support MSETNX"),
        b"MULTI"                        => anyhow::bail!("TODO: support MULTI"),
        b"OBJECT ENCODING"              => anyhow::bail!("TODO: support OBJECT ENCODING"),
        b"OBJECT FREQ"                  => anyhow::bail!("TODO: support OBJECT FREQ"),
        b"OBJECT IDLETIME"              => anyhow::bail!("TODO: support OBJECT IDLETIME"),
        b"OBJECT REFCOUNT"              => anyhow::bail!("TODO: support OBJECT REFCOUNT"),
        b"PERSIST"                      => anyhow::bail!("TODO: support PERSIST"),
        b"PEXPIRE"                      => anyhow::bail!("TODO: support PEXPIRE"),
        b"PEXPIREAT"                    => anyhow::bail!("TODO: support PEXPIREAT"),
        b"PEXPIRETIME"                  => anyhow::bail!("TODO: support PEXPIRETIME"),
        b"PFADD"                        => anyhow::bail!("TODO: support PFADD"),
        b"PFCOUNT"                      => anyhow::bail!("TODO: support PFCOUNT"),
        b"PFDEBUG"                      => anyhow::bail!("TODO: support PFDEBUG"),
        b"PFMERGE"                      => anyhow::bail!("TODO: support PFMERGE"),
        b"PFSELFTEST"                   => anyhow::bail!("TODO: support PFSELFTEST"),
        b"PING"                         => anyhow::bail!("TODO: support PING"),
        b"PSETEX"                       => anyhow::bail!("TODO: support PSETEX"),
        b"PSUBSCRIBE"                   => anyhow::bail!("TODO: support PSUBSCRIBE"),
        b"PSYNC"                        => anyhow::bail!("TODO: support PSYNC"),
        b"PTTL"                         => anyhow::bail!("TODO: support PTTL"),
        b"PUBLISH"                      => anyhow::bail!("TODO: support PUBLISH"),
        b"PUBSUB CHANNELS"              => anyhow::bail!("TODO: support PUBSUB CHANNELS"),
        b"PUBSUB NUMPAT"                => anyhow::bail!("TODO: support PUBSUB NUMPAT"),
        b"PUBSUB NUMSUB"                => anyhow::bail!("TODO: support PUBSUB NUMSUB"),
        b"PUBSUB SHARDCHANNELS"         => anyhow::bail!("TODO: support PUBSUB SHARDCHANNELS"),
        b"PUBSUB SHARDNUMSUB"           => anyhow::bail!("TODO: support PUBSUB SHARDNUMSUB"),
        b"PUNSUBSCRIBE"                 => anyhow::bail!("TODO: support PUNSUBSCRIBE"),
        b"QUIT"                         => anyhow::bail!("TODO: support QUIT"),
        b"RANDOMKEY"                    => anyhow::bail!("TODO: support RANDOMKEY"),
        b"READONLY"                     => anyhow::bail!("TODO: support READONLY"),
        b"READWRITE"                    => anyhow::bail!("TODO: support READWRITE"),
        b"RENAME"                       => anyhow::bail!("TODO: support RENAME"),
        b"RENAMENX"                     => anyhow::bail!("TODO: support RENAMENX"),
        b"REPLCONF"                     => anyhow::bail!("TODO: support REPLCONF"),
        b"REPLICAOF"                    => anyhow::bail!("TODO: support REPLICAOF"),
        b"RESET"                        => anyhow::bail!("TODO: support RESET"),
        b"RESTORE"                      => anyhow::bail!("TODO: support RESTORE"),
        b"RESTORE-ASKING"               => anyhow::bail!("TODO: support RESTORE-ASKING"),
        b"ROLE"                         => anyhow::bail!("TODO: support ROLE"),
        b"RPOP"                         => anyhow::bail!("TODO: support RPOP"),
        b"RPOPLPUSH"                    => anyhow::bail!("TODO: support RPOPLPUSH"),
        b"RPUSH"                        => anyhow::bail!("TODO: support RPUSH"),
        b"RPUSHX"                       => anyhow::bail!("TODO: support RPUSHX"),
        b"SADD"                         => anyhow::bail!("TODO: support SADD"),
        b"SAVE"                         => anyhow::bail!("TODO: support SAVE"),
        b"SCAN"                         => anyhow::bail!("TODO: support SCAN"),
        b"SCARD"                        => anyhow::bail!("TODO: support SCARD"),
        b"SCRIPT DEBUG"                 => anyhow::bail!("TODO: support SCRIPT DEBUG"),
        b"SCRIPT EXISTS"                => anyhow::bail!("TODO: support SCRIPT EXISTS"),
        b"SCRIPT FLUSH"                 => anyhow::bail!("TODO: support SCRIPT FLUSH"),
        b"SCRIPT KILL"                  => anyhow::bail!("TODO: support SCRIPT KILL"),
        b"SCRIPT LOAD"                  => anyhow::bail!("TODO: support SCRIPT LOAD"),
        b"SDIFF"                        => anyhow::bail!("TODO: support SDIFF"),
        b"SDIFFSTORE"                   => anyhow::bail!("TODO: support SDIFFSTORE"),
        b"SELECT"                       => anyhow::bail!("TODO: support SELECT"),
        b"SET"                          => anyhow::bail!("TODO: support SET"),
        b"SETBIT"                       => anyhow::bail!("TODO: support SETBIT"),
        b"SETEX"                        => anyhow::bail!("TODO: support SETEX"),
        b"SETNX"                        => anyhow::bail!("TODO: support SETNX"),
        b"SETRANGE"                     => anyhow::bail!("TODO: support SETRANGE"),
        b"SHUTDOWN"                     => anyhow::bail!("TODO: support SHUTDOWN"),
        b"SINTER"                       => anyhow::bail!("TODO: support SINTER"),
        b"SINTERCARD"                   => anyhow::bail!("TODO: support SINTERCARD"),
        b"SINTERSTORE"                  => anyhow::bail!("TODO: support SINTERSTORE"),
        b"SISMEMBER"                    => anyhow::bail!("TODO: support SISMEMBER"),
        b"SLAVEOF"                      => anyhow::bail!("TODO: support SLAVEOF"),
        b"SLOWLOG GET"                  => anyhow::bail!("TODO: support SLOWLOG GET"),
        b"SLOWLOG LEN"                  => anyhow::bail!("TODO: support SLOWLOG LEN"),
        b"SLOWLOG RESET"                => anyhow::bail!("TODO: support SLOWLOG RESET"),
        b"SMEMBERS"                     => anyhow::bail!("TODO: support SMEMBERS"),
        b"SMISMEMBER"                   => anyhow::bail!("TODO: support SMISMEMBER"),
        b"SMOVE"                        => anyhow::bail!("TODO: support SMOVE"),
        b"SORT"                         => anyhow::bail!("TODO: support SORT"),
        b"SORT_RO"                      => anyhow::bail!("TODO: support SORT_RO"),
        b"SPOP"                         => anyhow::bail!("TODO: support SPOP"),
        b"SPUBLISH"                     => anyhow::bail!("TODO: support SPUBLISH"),
        b"SRANDMEMBER"                  => anyhow::bail!("TODO: support SRANDMEMBER"),
        b"SREM"                         => anyhow::bail!("TODO: support SREM"),
        b"SSCAN"                        => anyhow::bail!("TODO: support SSCAN"),
        b"SSUBSCRIBE"                   => anyhow::bail!("TODO: support SSUBSCRIBE"),
        b"STRLEN"                       => anyhow::bail!("TODO: support STRLEN"),
        b"SUBSCRIBE"                    => anyhow::bail!("TODO: support SUBSCRIBE"),
        b"SUBSTR"                       => anyhow::bail!("TODO: support SUBSTR"),
        b"SUNION"                       => anyhow::bail!("TODO: support SUNION"),
        b"SUNIONSTORE"                  => anyhow::bail!("TODO: support SUNIONSTORE"),
        b"SUNSUBSCRIBE"                 => anyhow::bail!("TODO: support SUNSUBSCRIBE"),
        b"SWAPDB"                       => anyhow::bail!("TODO: support SWAPDB"),
        b"SYNC"                         => anyhow::bail!("TODO: support SYNC"),
        b"TDIGEST.ADD"                  => anyhow::bail!("TODO: support TDIGEST.ADD"),
        b"TDIGEST.BYRANK"               => anyhow::bail!("TODO: support TDIGEST.BYRANK"),
        b"TDIGEST.BYREVRANK"            => anyhow::bail!("TODO: support TDIGEST.BYREVRANK"),
        b"TDIGEST.CDF"                  => anyhow::bail!("TODO: support TDIGEST.CDF"),
        b"TDIGEST.CREATE"               => anyhow::bail!("TODO: support TDIGEST.CREATE"),
        b"TDIGEST.INFO"                 => anyhow::bail!("TODO: support TDIGEST.INFO"),
        b"TDIGEST.MAX"                  => anyhow::bail!("TODO: support TDIGEST.MAX"),
        b"TDIGEST.MERGE"                => anyhow::bail!("TODO: support TDIGEST.MERGE"),
        b"TDIGEST.MIN"                  => anyhow::bail!("TODO: support TDIGEST.MIN"),
        b"TDIGEST.QUANTILE"             => anyhow::bail!("TODO: support TDIGEST.QUANTILE"),
        b"TDIGEST.RANK"                 => anyhow::bail!("TODO: support TDIGEST.RANK"),
        b"TDIGEST.RESET"                => anyhow::bail!("TODO: support TDIGEST.RESET"),
        b"TDIGEST.REVRANK"              => anyhow::bail!("TODO: support TDIGEST.REVRANK"),
        b"TDIGEST.TRIMMED_MEAN"         => anyhow::bail!("TODO: support TDIGEST.TRIMMED_MEAN"),
        b"TFCALL"                       => anyhow::bail!("TODO: support TFCALL"),
        b"TFCALLASYNC"                  => anyhow::bail!("TODO: support TFCALLASYNC"),
        b"TFUNCTION DELETE"             => anyhow::bail!("TODO: support TFUNCTION DELETE"),
        b"TFUNCTION LIST"               => anyhow::bail!("TODO: support TFUNCTION LIST"),
        b"TFUNCTION LOAD"               => anyhow::bail!("TODO: support TFUNCTION LOAD"),
        b"TIME"                         => anyhow::bail!("TODO: support TIME"),
        b"TOPK.ADD"                     => anyhow::bail!("TODO: support TOPK.ADD"),
        b"TOPK.COUNT"                   => anyhow::bail!("TODO: support TOPK.COUNT"),
        b"TOPK.INCRBY"                  => anyhow::bail!("TODO: support TOPK.INCRBY"),
        b"TOPK.INFO"                    => anyhow::bail!("TODO: support TOPK.INFO"),
        b"TOPK.LIST"                    => anyhow::bail!("TODO: support TOPK.LIST"),
        b"TOPK.QUERY"                   => anyhow::bail!("TODO: support TOPK.QUERY"),
        b"TOPK.RESERVE"                 => anyhow::bail!("TODO: support TOPK.RESERVE"),
        b"TOUCH"                        => anyhow::bail!("TODO: support TOUCH"),
        b"TS.ADD"                       => anyhow::bail!("TODO: support TS.ADD"),
        b"TS.ALTER"                     => anyhow::bail!("TODO: support TS.ALTER"),
        b"TS.CREATE"                    => anyhow::bail!("TODO: support TS.CREATE"),
        b"TS.CREATERULE"                => anyhow::bail!("TODO: support TS.CREATERULE"),
        b"TS.DECRBY"                    => anyhow::bail!("TODO: support TS.DECRBY"),
        b"TS.DEL"                       => anyhow::bail!("TODO: support TS.DEL"),
        b"TS.DELETERULE"                => anyhow::bail!("TODO: support TS.DELETERULE"),
        b"TS.GET"                       => anyhow::bail!("TODO: support TS.GET"),
        b"TS.INCRBY"                    => anyhow::bail!("TODO: support TS.INCRBY"),
        b"TS.INFO"                      => anyhow::bail!("TODO: support TS.INFO"),
        b"TS.MADD"                      => anyhow::bail!("TODO: support TS.MADD"),
        b"TS.MGET"                      => anyhow::bail!("TODO: support TS.MGET"),
        b"TS.MRANGE"                    => anyhow::bail!("TODO: support TS.MRANGE"),
        b"TS.MREVRANGE"                 => anyhow::bail!("TODO: support TS.MREVRANGE"),
        b"TS.QUERYINDEX"                => anyhow::bail!("TODO: support TS.QUERYINDEX"),
        b"TS.RANGE"                     => anyhow::bail!("TODO: support TS.RANGE"),
        b"TS.REVRANGE"                  => anyhow::bail!("TODO: support TS.REVRANGE"),
        b"TTL"                          => anyhow::bail!("TODO: support TTL"),
        b"TYPE"                         => anyhow::bail!("TODO: support TYPE"),
        b"UNLINK"                       => anyhow::bail!("TODO: support UNLINK"),
        b"UNSUBSCRIBE"                  => anyhow::bail!("TODO: support UNSUBSCRIBE"),
        b"UNWATCH"                      => anyhow::bail!("TODO: support UNWATCH"),
        b"WAIT"                         => anyhow::bail!("TODO: support WAIT"),
        b"WAITAOF"                      => anyhow::bail!("TODO: support WAITAOF"),
        b"WATCH"                        => anyhow::bail!("TODO: support WATCH"),
        b"XACK"                         => anyhow::bail!("TODO: support XACK"),
        b"XADD"                         => anyhow::bail!("TODO: support XADD"),
        b"XAUTOCLAIM"                   => anyhow::bail!("TODO: support XAUTOCLAIM"),
        b"XCLAIM"                       => anyhow::bail!("TODO: support XCLAIM"),
        b"XDEL"                         => anyhow::bail!("TODO: support XDEL"),
        b"XGROUP CREATE"                => anyhow::bail!("TODO: support XGROUP CREATE"),
        b"XGROUP CREATECONSUMER"        => anyhow::bail!("TODO: support XGROUP CREATECONSUMER"),
        b"XGROUP DELCONSUMER"           => anyhow::bail!("TODO: support XGROUP DELCONSUMER"),
        b"XGROUP DESTROY"               => anyhow::bail!("TODO: support XGROUP DESTROY"),
        b"XGROUP SETID"                 => anyhow::bail!("TODO: support XGROUP SETID"),
        b"XINFO CONSUMERS"              => anyhow::bail!("TODO: support XINFO CONSUMERS"),
        b"XINFO GROUPS"                 => anyhow::bail!("TODO: support XINFO GROUPS"),
        b"XINFO STREAM"                 => anyhow::bail!("TODO: support XINFO STREAM"),
        b"XLEN"                         => anyhow::bail!("TODO: support XLEN"),
        b"XPENDING"                     => anyhow::bail!("TODO: support XPENDING"),
        b"XRANGE"                       => anyhow::bail!("TODO: support XRANGE"),
        b"XREAD"                        => anyhow::bail!("TODO: support XREAD"),
        b"XREADGROUP"                   => anyhow::bail!("TODO: support XREADGROUP"),
        b"XREVRANGE"                    => anyhow::bail!("TODO: support XREVRANGE"),
        b"XSETID"                       => anyhow::bail!("TODO: support XSETID"),
        b"XTRIM"                        => anyhow::bail!("TODO: support XTRIM"),
        b"ZADD"                         => anyhow::bail!("TODO: support ZADD"),
        b"ZCARD"                        => anyhow::bail!("TODO: support ZCARD"),
        b"ZCOUNT"                       => anyhow::bail!("TODO: support ZCOUNT"),
        b"ZDIFF"                        => anyhow::bail!("TODO: support ZDIFF"),
        b"ZDIFFSTORE"                   => anyhow::bail!("TODO: support ZDIFFSTORE"),
        b"ZINCRBY"                      => anyhow::bail!("TODO: support ZINCRBY"),
        b"ZINTER"                       => anyhow::bail!("TODO: support ZINTER"),
        b"ZINTERCARD"                   => anyhow::bail!("TODO: support ZINTERCARD"),
        b"ZINTERSTORE"                  => anyhow::bail!("TODO: support ZINTERSTORE"),
        b"ZLEXCOUNT"                    => anyhow::bail!("TODO: support ZLEXCOUNT"),
        b"ZMPOP"                        => anyhow::bail!("TODO: support ZMPOP"),
        b"ZMSCORE"                      => anyhow::bail!("TODO: support ZMSCORE"),
        b"ZPOPMAX"                      => anyhow::bail!("TODO: support ZPOPMAX"),
        b"ZPOPMIN"                      => anyhow::bail!("TODO: support ZPOPMIN"),
        b"ZRANDMEMBER"                  => anyhow::bail!("TODO: support ZRANDMEMBER"),
        b"ZRANGE"                       => anyhow::bail!("TODO: support ZRANGE"),
        b"ZRANGEBYLEX"                  => anyhow::bail!("TODO: support ZRANGEBYLEX"),
        b"ZRANGEBYSCORE"                => anyhow::bail!("TODO: support ZRANGEBYSCORE"),
        b"ZRANGESTORE"                  => anyhow::bail!("TODO: support ZRANGESTORE"),
        b"ZRANK"                        => anyhow::bail!("TODO: support ZRANK"),
        b"ZREM"                         => anyhow::bail!("TODO: support ZREM"),
        b"ZREMRANGEBYLEX"               => anyhow::bail!("TODO: support ZREMRANGEBYLEX"),
        b"ZREMRANGEBYRANK"              => anyhow::bail!("TODO: support ZREMRANGEBYRANK"),
        b"ZREMRANGEBYSCORE"             => anyhow::bail!("TODO: support ZREMRANGEBYSCORE"),
        b"ZREVRANGE"                    => anyhow::bail!("TODO: support ZREVRANGE"),
        b"ZREVRANGEBYLEX"               => anyhow::bail!("TODO: support ZREVRANGEBYLEX"),
        b"ZREVRANGEBYSCORE"             => anyhow::bail!("TODO: support ZREVRANGEBYSCORE"),
        b"ZREVRANK"                     => anyhow::bail!("TODO: support ZREVRANK"),
        b"ZSCAN"                        => anyhow::bail!("TODO: support ZSCAN"),
        b"ZSCORE"                       => anyhow::bail!("TODO: support ZSCORE"),
        b"ZUNION"                       => anyhow::bail!("TODO: support ZUNION"),
        b"ZUNIONSTORE"                  => anyhow::bail!("TODO: support ZUNIONSTORE"),
        _ => anyhow::bail!("Unrecognized command: {:?}", cmd[0]),
    }
}

fn main() -> anyhow::Result<()> {
    let mut parser = Parser::new(b"*2\r\n$4\r\nLLEN\r\n$6\r\nmylist\r\n".as_slice());
    let mut state = HashMap::new();
    let cmd = parser.read_string_array()?;
    execute_command(&mut state, &cmd)
}
